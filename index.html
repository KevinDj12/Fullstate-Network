<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FN | Fullstate Network</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .header {
            background: #323232;
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .header .logo {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 1px;
        }
        .header .nav a {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
            font-size: 1rem;
            transition: color 0.3s ease;
            cursor: pointer;
        }
        .header .nav a:hover {
            color: #facc15;
        }
        .header .nav a.active {
            color: #facc15;
            border-bottom: 2px solid #facc15;
        }
        .header .search {
            display: flex;
            align-items: center;
        }
        .header .search input {
            padding: 0.5rem;
            border: none;
            border-radius: 20px 0 0 20px;
            outline: none;
            font-size: 0.9rem;
        }
        .header .search button {
            padding: 0.5rem 1rem;
            border: none;
            background: #facc15;
            color: #1e3a8a;
            border-radius: 0 20px 20px 0;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .header .search button:hover {
            background: #eab308;
        }
        .content {
            display: none;
            padding: 4rem 2rem;
            text-align: center;
            flex: 1 0 auto;
        }
        .content.active {
            display: flex;
            flex-direction: column;
        }
        .hero {
            background: #000000;
            color: white;
            text-align: center;
            padding: 5rem 2rem;
            position: relative;
        }
        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .hero .buttons {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
        }
        .hero .buttons button {
            padding: 0.75rem 2rem;
            font-size: 1.1rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hero .buttons .check-btn {
            background: #3b82f6;
            color: white;
        }
        .hero .buttons button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .services {
            padding: 4rem 2rem;
            text-align: center;
        }
        .services h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #1e3a8a;
            font-weight: 600;
        }
        .services .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        .services .card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .services .card:hover {
            transform: translateY(-5px);
        }
        .services .card img {
            width: 60px;
            margin-bottom: 1rem;
        }
        .services .card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #1e3a8a;
        }
        .services .card p {
            font-size: 1rem;
            color: #666;
        }
        .news-list {
            padding: 4rem 2rem;
            text-align: center;
            background: #e6effb;
        }
        .news-list h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #1e3a8a;
        }
        .news-list .news-items {
            display: block;
            max-width: 1200px;
            margin: 0 auto;
        }
        .news-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .news-item:hover {
            transform: translateY(-3px);
        }
        .news-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 50%;
            margin-right: 1rem;
        }
        .news-item .info {
            text-align: left;
            flex-grow: 1;
        }
        .news-item .info span.category {
            font-size: 0.8rem;
            color: #1e3a8a;
            margin-bottom: 0.2rem;
            display: block;
        }
        .news-item .info span.date {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.2rem;
            display: block;
        }
        .news-item .info h3 {
            font-size: 1.2rem;
            color: #1e3a8a;
            margin-bottom: 0.3rem;
        }
        .news-item .info p {
            font-size: 0.9rem;
            color: #666;
        }
        .news-item button.delete-btn {
            padding: 0.25rem 0.75rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s ease;
            display: none;
        }
        .news-item button.delete-btn.visible {
            display: block;
        }
        .news-item button.delete-btn:hover {
            background: #dc2626;
        }
        .news-detail {
            padding: 4rem 2rem;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            min-height: calc(100vh - 300px);
            overflow-y: auto;
        }
        .news-detail .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .news-detail .back-btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: #3b82f6;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            cursor: pointer;
            text-align: left;
            width: fit-content;
        }
        .news-detail .back-btn:hover {
            background: #2563eb;
        }
        .news-detail .delete-btn {
            display: none;
            padding: 0.5rem 1rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .news-detail .delete-btn.visible {
            display: inline-block;
        }
        .news-detail .delete-btn:hover {
            background: #dc2626;
        }
        .news-detail img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1rem;
        }
        .news-detail h3 {
            font-size: 1.8rem;
            color: #1e3a8a;
            margin-bottom: 0.5rem;
        }
        .news-detail p {
            font-size: 1rem;
            color: #666;
            line-height: 1.8;
            text-align: left;
            flex: 1 0 auto;
            overflow-wrap: break-word;
        }
        .admin {
            padding: 4rem 2rem;
            text-align: center;
            background: #e6effb;
        }
        .admin h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #1e3a8a;
        }
        .admin .add-news {
            display: none;
            margin-bottom: 2rem;
            text-align: left;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .admin .add-news.active {
            display: block;
        }
        .admin .add-news select, .admin .add-news input, .admin .add-news textarea {
            display: block;
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            outline: none;
        }
        .admin .add-news p {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
            line-height: 1.4;
        }
        .admin .add-news button {
            padding: 0.5rem 1rem;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .admin .add-news button:hover {
            background: #2563eb;
        }
        .admin .news-list {
            max-width: 800px;
            margin: 0 auto;
            margin-top: 2rem;
        }
        .admin .news-list .news-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .admin .news-list .news-item .info {
            text-align: left;
            flex-grow: 1;
        }
        .admin .news-list .news-item button {
            padding: 0.25rem 0.75rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .admin .news-list .news-item button:hover {
            background: #dc2626;
        }
        .admin .logout-btn {
            padding: 0.5rem 1rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s ease;
            margin-top: 2rem;
        }
        .admin .logout-btn:hover {
            background: #dc2626;
        }
        .profile, .community {
            padding: 4rem 2rem;
            text-align: center;
        }
        .profile h2, .community h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #1e3a8a;
        }
        .profile p, .community p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            color: #666;
        }
        .profile .profile-highlight {
            display: block;
            max-width: 800px;
            margin: 2rem auto 0 auto;
        }
        .profile .profile-highlight .news-item {
            cursor: default; /* Menghapus kursor pointer */
            pointer-events: none; /* Menonaktifkan klik */
        }
        #login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        #login-modal.active {
            display: flex;
        }
        .login-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            width: 300px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        .login-content h3 {
            margin-bottom: 1rem;
            color: #1e3a8a;
        }
        .login-content input {
            display: block;
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            outline: none;
        }
        .login-content button {
            padding: 0.5rem 1rem;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .login-content button:hover {
            background: #2563eb;
        }
        .close-btn {
            margin-top: 1rem;
            color: #666;
            cursor: pointer;
            text-decoration: underline;
        }
        .footer {
            background: #1e3a8a;
            color: white;
            padding: 2rem;
            text-align: left;
            flex-shrink: 0;
            width: 100%;
            position: relative;
        }
        .footer .footer-content {
            display: flex;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap;
        }
        .footer .footer-section {
            margin-bottom: 1rem;
        }
        .footer .footer-section h4 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        .footer .footer-section ul {
            list-style: none;
        }
        .footer .footer-section ul li {
            margin-bottom: 0.3rem;
        }
        .footer .footer-section ul li a {
            color: white;
            text-decoration: none;
        }
        .footer .footer-section ul li a:hover {
            text-decoration: underline;
        }
        .footer .footer-section ul li a.button {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: #3b82f6;
            color: white;
            text-decoration: none;
            border-radius: 20px;
            cursor: pointer;
            text-align: left;
            width: fit-content;
        }
        .footer .footer-section ul li a.button:hover {
            background: #2563eb;
            text-decoration: none;
        }
        .footer .footer-bottom {
            text-align: center;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">FN | Fullstate Network</div>
        <div class="nav" id="nav-links">
            <a onclick="showPage('home')" class="active">Beranda</a>
            <a onclick="showPage('profile')">Profil</a>
            <a onclick="showPage('news-list')">Berita</a>
            <a onclick="showPage('community')">Komunitas</a>
        </div>
        <div class="search">
            <input type="text" placeholder="Cari Berita...">
            <button>üîç</button>
        </div>
    </div>
    <div id="home" class="content active">
        <div class="hero">
            <h1>SELALU UPDATE SETIAP MINGGU</h1>
            <p>Fullstate Network adalah platform terpercaya yang menyiarkan berita di Fullstate, memberikan informasi terkini setiap minggu.</p>
            <div class="buttons">
                <button id="check-news-btn" class="check-btn" onclick="showPage('news-list')">Cek Berita Terbaru</button>
            </div>
        </div>
        <div class="services">
            <h2>LAYANAN BERITA</h2>
            <div class="grid">
                <div class="card">
                    <img src="Newspaper Icon.png" alt="Berita Menarik">
                    <h3>BERITA MENARIK</h3>
                    <p>Akses berita menarik dengan cepat dan mudah.</p>
                </div>
                <div class="card">
                    <img src="Live Camera Icon.png" alt="Live Update">
                    <h3>LIVE UPDATE</h3>
                    <p>Dapatkan pembaruan berita langsung dengan proses yang efisien.</p>
                </div>
                <div class="card">
                    <img src="Arsip Berita.png" alt="Arsip Berita">
                    <h3>ARSIP BERITA</h3>
                    <p>Akses arsip berita melalui platform digital kami.</p>
                </div>
            </div>
        </div>
    </div>
    <div id="profile" class="content">
        <div class="profile">
            <h2>Profil Fullstate Network</h2>
            <p>Fullstate Network adalah penyiar berita terkemuka di Fullstate, berkomitmen untuk menyampaikan informasi yang akurat dan terpercaya. Kami telah melayani masyarakat sejak 2022, dengan tim jurnalis berpengalaman yang berdedikasi untuk mengungkap kebenaran.</p>
            <div class="profile-highlight">
                <div class="news-item">
                    <img src="Dir.png" alt="Direktur">
                    <div class="info">
                        <span class="category">Direktur</span>
                        <span class="date"></span>
                        <h3>Ven Christopher S. Ds, M. Ds</h3>
                        <p>Direktur Fullstate Network.</p>
                    </div>
                </div>
                <div class="news-item">
                    <img src="Wadir.png" alt="Wakil Direktur">
                    <div class="info">
                        <span class="category">Wakil Direktur</span>
                        <span class="date"></span>
                        <h3>Ojaan</h3>
                        <p>Wakil Direktur Fullstate Network.</p>
                    </div>
                </div>
                <div class="news-item">
                    <img src="Kadir.png" alt="Kepala Direksi">
                    <div class="info">
                        <span class="category">Kepala Direksi</span>
                        <span class="date"></span>
                        <h3>Bariq</h3>
                        <p>Kepala Direksi Fullstate Network.</p>
                    </div>
                </div>
                <div class="news-item">
                    <img src="Wakadir.png" alt="Wakil Kepala Direksi">
                    <div class="info">
                        <span class="category">Wakil Kepala Direksi</span>
                        <span class="date"></span>
                        <h3>Welly</h3>
                        <p>Wakil Kepala Direksi Fullstate Network.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="news-list" class="content">
        <h2>Berita Terkini</h2>
        <div class="news-items" id="news-items">
            <!-- Berita akan dimuat secara dinamis -->
        </div>
    </div>
    <div id="community" class="content">
        <div class="community">
            <h2>Komunitas Fullstate Network</h2>
            <p>Bergabunglah dengan komunitas kami untuk berbagi cerita, diskusi, dan informasi. Fullstate Network mendukung komunitas yang aktif dan terhubung, tempat Anda bisa berpartisipasi dalam berbagai kegiatan sosial dan jurnalisme warga.</p>
        </div>
    </div>
    <div id="admin" class="content">
        <div class="admin">
            <h2>Panel Admin</h2>
            <div class="add-news">
                <button onclick="toggleAddNewsForm()">Tambah Berita</button>
                <form id="add-news-form" style="display: none;">
                    <select name="category" id="news-category" required>
                        <option value="" disabled selected>Pilih Kategori</option>
                        <option value="accident">Kecelakaan</option>
                        <option value="politics">Politik</option>
                        <option value="sports">Olahraga</option>
                        <option value="art">Seni</option>
                        <option value="information">Informasi</option>
                    </select>
                    <input type="text" id="news-title" placeholder="Judul Berita" required>
                    <textarea id="news-content" placeholder="Isi Berita" rows="4" required></textarea>
                    <input type="text" id="news-image-url" placeholder="Masukkan Direct Link dari Imgbox (contoh: https://thumbs2.imgbox.com/ab/cd/efgh1234_t.jpg)" required>
                    <p>Cara mendapatkan Direct Link dari Imgbox:<br>
                    1. Buka situs Imgbox (cari "Imgbox image hosting" di mesin pencari).<br>
                    2. Klik "Upload" dan pilih gambar dari perangkat Anda (maksimal 10 MB).<br>
                    3. Setelah selesai, salin "Direct Link" (biasanya berakhiran .jpg atau .png).<br>
                    4. Tempelkan tautan tersebut di kolom ini.</p>
                    <button type="submit">Kirim Berita</button>
                </form>
            </div>
            <div class="news-list" id="admin-news-list">
                <!-- Berita yang dapat dihapus akan ditampilkan di sini -->
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </div>

    <div id="login-modal">
        <div class="login-content">
            <h3>Login Admin</h3>
            <input type="text" id="username" placeholder="Username">
            <input type="password" id="password" placeholder="Password">
            <button onclick="login()">Login</button>
            <div class="close-btn" onclick="closeLoginModal()">Tutup</div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Tautan</h4>
                <ul>
                    <li><a href="#" class="button" onclick="showLoginModal()">Login Admin</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Jam Operasional</h4>
                <ul>
                    <li>Senin - Minggu: 15:00 - 21:30</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Alamat</h4>
                <ul>
                    <li>Saat ini alamat belum tersedia untuk Fullstate Network dan akan segera kami tambahkan apabila telah mendapat gedung di kota.</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            ¬©2025 FN | Fullstate Network<br>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

    <script>
        // Konfigurasi Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCNuLH9W-LqSkyLgZyqGzzXi_q50pb7bXQ",
            authDomain: "fullstate-network.firebaseapp.com",
            projectId: "fullstate-network",
            storageBucket: "fullstate-network.firebasestorage.app",
            messagingSenderId: "538971846872",
            appId: "1:538971846872:web:4c7f49386e5325f8eebfad",
            measurementId: "G-4SG58WYT4G"
        };

        // Inisialisasi Firebase dengan error handling
        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log("Firebase initialized successfully.");
        } catch (error) {
            console.error("Failed to initialize Firebase:", error);
            alert("Gagal menginisialisasi Firebase. Fitur berita mungkin tidak berfungsi, tetapi navigasi tetap dapat digunakan.");
        }

        let isLoggedIn = false; // Set default to false on page load
        let newsData = [];

        // Periksa sessionStorage hanya untuk menentukan status awal
        if (sessionStorage.getItem('isLoggedIn') === 'true') {
            isLoggedIn = true;
        }

        // Pemetaan kategori dari bahasa Inggris ke bahasa Indonesia
        const categoryTranslations = {
            'accident': 'Kecelakaan',
            'politics': 'Politik',
            'sports': 'Olahraga'
        };

        function getTranslatedCategory(category) {
            return categoryTranslations[category.toLowerCase()] || category.charAt(0).toUpperCase() + category.slice(1);
        }

        function showPage(pageId) {
            console.log(`Showing page: ${pageId}, isLoggedIn: ${isLoggedIn}`);
            // Sembunyikan semua konten
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            // Tampilkan halaman yang diminta
            const contentSection = document.getElementById(pageId);
            if (contentSection) {
                contentSection.classList.add('active');
            } else {
                console.error(`Element with ID ${pageId} not found.`);
                if (newsData.find(news => news.id === pageId)) {
                    showNewsDetail(pageId);
                } else {
                    showPage('news-list'); // Kembali ke daftar berita jika ID tidak valid
                }
                return;
            }
            // Perbarui tautan navigasi aktif
            document.querySelectorAll('.nav a').forEach(link => {
                link.classList.remove('active');
            });
            const navLinks = document.querySelectorAll('.nav a');
            let foundLink = false;
            navLinks.forEach(link => {
                const onclickAttr = link.getAttribute('onclick');
                if (onclickAttr && onclickAttr.includes(`showPage('${pageId}')`)) {
                    link.classList.add('active');
                    foundLink = true;
                }
            });
            if (!foundLink) {
                console.warn(`No navigation link found for page ${pageId}.`);
            }
            // Perbarui tombol "Cek Berita Terbaru" di halaman Beranda
            const checkNewsBtn = document.getElementById('check-news-btn');
            if (checkNewsBtn && pageId === 'news-list' && sessionStorage.getItem('fromOtherPage') === 'true') {
                checkNewsBtn.textContent = 'Kembali';
                checkNewsBtn.onclick = () => showPage('home');
                sessionStorage.removeItem('fromOtherPage');
            } else if (checkNewsBtn && pageId === 'home') {
                checkNewsBtn.textContent = 'Cek Berita Terbaru';
                checkNewsBtn.onclick = () => {
                    sessionStorage.setItem('fromOtherPage', 'true');
                    showPage('news-list');
                };
            }
            // Logika untuk halaman admin
            if (pageId === 'admin' && !isLoggedIn) {
                alert('Silakan login sebagai admin untuk mengakses panel ini.');
                showPage('home');
                return;
            }
            if (isLoggedIn && pageId === 'admin') {
                const addNewsSection = document.querySelector('#admin .add-news');
                if (addNewsSection) {
                    addNewsSection.classList.add('active');
                    console.log('Admin panel should now be visible.');
                    if (db) loadAdminNewsList();
                } else {
                    console.error('Add news section not found in admin panel.');
                }
            }
            // Muat berita hanya jika di halaman news-list dan Firebase tersedia
            if (pageId === 'news-list' && db) {
                loadNews();
            }
            updateNavigation();
            updateDeleteButtonsVisibility();
        }

        function showNewsDetail(newsId) {
            const news = newsData.find(n => n.id === newsId);
            if (!news) {
                console.error(`News with ID ${newsId} not found.`);
                showPage('news-list');
                return;
            }

            let newsDetail = document.getElementById(newsId);
            if (!newsDetail) {
                newsDetail = document.createElement('div');
                newsDetail.id = newsId;
                newsDetail.className = 'content';
                newsDetail.innerHTML = `
                    <div class="news-detail">
                        <img src="${news.image}" alt="${getTranslatedCategory(news.category)}" onerror="this.onerror=null; this.src='https://via.placeholder.com/800x300?text=${getTranslatedCategory(news.category)}';">
                        <h3>${news.title}</h3>
                        <p>${news.content}</p>
                        <div class="button-group">
                            <a class="back-btn" onclick="showPage('news-list')">Kembali</a>
                            <button class="delete-btn" onclick="deleteNews('${news.id}')">Hapus Berita</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(newsDetail);
            }
            showPage(newsId);
        }

        function showLoginModal() {
            const modal = document.getElementById('login-modal');
            if (modal) {
                modal.classList.add('active');
            } else {
                console.error('Login modal not found.');
            }
        }

        function closeLoginModal() {
            const modal = document.getElementById('login-modal');
            if (modal) {
                modal.classList.remove('active');
                const usernameInput = document.getElementById('username');
                const passwordInput = document.getElementById('password');
                if (usernameInput) usernameInput.value = '';
                if (passwordInput) passwordInput.value = '';
            } else {
                console.error('Login modal not found.');
            }
        }

        function login() {
            const username = document.getElementById('username')?.value;
            const password = document.getElementById('password')?.value;
            if (!username || !password) {
                alert('Mohon masukkan username dan password.');
                return;
            }
            if (username === 'FULLSTATENETWORK' && password === 'FULLSTATENETWORKJAYASELAMANYA') {
                alert('Login berhasil! Selamat datang, Admin!');
                isLoggedIn = true;
                sessionStorage.setItem('isLoggedIn', 'true');
                closeLoginModal();
                updateNavigation();
                showPage('admin');
                updateDeleteButtonsVisibility();
            } else {
                alert('Username atau password salah!');
            }
        }

        function toggleAddNewsForm() {
            const form = document.getElementById('add-news-form');
            if (form) {
                if (form.style.display === 'none' || form.style.display === '') {
                    form.style.display = 'block';
                } else {
                    form.style.display = 'none';
                }
            } else {
                console.error('Add news form not found.');
            }
        }

        function formatDateTime() {
            const now = new Date();
            const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
            const day = days[now.getDay()];
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const date = now.getDate();
            const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            return `${day}, ${hours}:${minutes} WIB, ${date} ${month} ${year}`;
        }

        async function addNews(event) {
            event.preventDefault();
            if (!db) {
                alert('Firebase tidak tersedia. Tidak dapat menambahkan berita.');
                return;
            }

            const category = document.getElementById('news-category')?.value;
            const title = document.getElementById('news-title')?.value;
            const content = document.getElementById('news-content')?.value;
            let imageUrl = document.getElementById('news-image-url')?.value;

            if (!category || !title || !content || !imageUrl) {
                alert('Semua field harus diisi!');
                return;
            }

            // Validasi URL gambar lebih ketat
            imageUrl = imageUrl.trim();
            if (!imageUrl.includes('imgbox.com') || !/\.(jpg|jpeg|png|gif)$/i.test(imageUrl)) {
                alert('Harap masukkan Direct Link yang valid dari Imgbox (contoh: https://thumbs2.imgbox.com/ab/cd/efgh1234_t.jpg). Pastikan URL berakhiran .jpg, .jpeg, .png, atau .gif.');
                return;
            }

            try {
                const dateTime = formatDateTime();
                const newNews = {
                    category: category,
                    title: title,
                    content: content,
                    dateTime: dateTime,
                    image: imageUrl,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                const docRef = await db.collection('news').add(newNews);
                const newNewsId = docRef.id;

                await docRef.update({ id: newNewsId });

                const newsItems = document.getElementById('news-items');
                if (newsItems) {
                    const newNewsItem = document.createElement('div');
                    newNewsItem.className = 'news-item';
                    newNewsItem.onclick = () => showNewsDetail(newNewsId);
                    newNewsItem.innerHTML = `
                        <img src="${imageUrl}" alt="${getTranslatedCategory(category)}" onerror="this.onerror=null; this.src='https://via.placeholder.com/24?text=${getTranslatedCategory(category)}';">
                        <div class="info">
                            <span class="category">${getTranslatedCategory(category)}</span>
                            <span class="date">${dateTime}</span>
                            <h3>${title}</h3>
                            <p>${content.substring(0, 50)}...</p>
                        </div>
                        <button class="delete-btn" onclick="event.stopPropagation(); deleteNews('${newNewsId}')">Hapus Berita</button>
                    `;
                    newsItems.insertBefore(newNewsItem, newsItems.firstChild);

                    document.getElementById('add-news-form').reset();
                    toggleAddNewsForm();
                    alert('Berita berhasil ditambahkan!');
                    showPage('news-list');
                    if (db) loadAdminNewsList();
                    updateDeleteButtonsVisibility();
                } else {
                    console.error('Element with ID "news-items" not found.');
                }
            } catch (error) {
                console.error('Error adding news:', error);
                alert('Gagal menambahkan berita. Silakan coba lagi.');
            }
        }

        async function loadNews() {
            if (!db) {
                console.warn('Firebase not initialized. Skipping loadNews.');
                return;
            }

            const newsItems = document.getElementById('news-items');
            if (!newsItems) {
                console.error('Element with ID "news-items" not found.');
                return;
            }

            try {
                newsItems.innerHTML = '';

                const snapshot = await db.collection('news')
                    .orderBy('createdAt', 'desc')
                    .get();

                newsData = [];
                snapshot.forEach(doc => {
                    const news = doc.data();
                    console.log('News Image URL:', news.image); // Log URL gambar untuk debugging
                    newsData.push(news);

                    const newNewsItem = document.createElement('div');
                    newNewsItem.className = 'news-item';
                    newNewsItem.onclick = () => showNewsDetail(news.id);
                    newNewsItem.innerHTML = `
                        <img src="${news.image}" alt="${getTranslatedCategory(news.category)}" onerror="this.onerror=null; this.src='https://via.placeholder.com/24?text=${getTranslatedCategory(news.category)}';">
                        <div class="info">
                            <span class="category">${getTranslatedCategory(news.category)}</span>
                            <span class="date">${news.dateTime}</span>
                            <h3>${news.title}</h3>
                            <p>${news.content.substring(0, 50)}...</p>
                        </div>
                        <button class="delete-btn" onclick="event.stopPropagation(); deleteNews('${news.id}')">Hapus Berita</button>
                    `;
                    newsItems.appendChild(newNewsItem);

                    let newsDetail = document.getElementById(news.id);
                    if (!newsDetail) {
                        newsDetail = document.createElement('div');
                        newsDetail.id = news.id;
                        newsDetail.className = 'content';
                        newsDetail.innerHTML = `
                            <div class="news-detail">
                                <img src="${news.image}" alt="${getTranslatedCategory(news.category)}" onerror="this.onerror=null; this.src='https://via.placeholder.com/800x300?text=${getTranslatedCategory(news.category)}';">
                                <h3>${news.title}</h3>
                                <p>${news.content}</p>
                                <div class="button-group">
                                    <a class="back-btn" onclick="showPage('news-list')">Kembali</a>
                                    <button class="delete-btn" onclick="deleteNews('${news.id}')">Hapus Berita</button>
                                </div>
                            </div>
                        `;
                        document.body.appendChild(newsDetail);
                    }
                });
                updateDeleteButtonsVisibility();
            } catch (error) {
                console.error('Error loading news:', error);
                alert('Gagal memuat berita. Periksa konsol untuk detail lebih lanjut.');
            }
        }

        async function loadAdminNewsList() {
            if (!db) {
                console.warn('Firebase not initialized. Skipping loadAdminNewsList.');
                return;
            }

            try {
                const adminNewsList = document.getElementById('admin-news-list');
                if (!adminNewsList) {
                    console.error('Admin news list element not found.');
                    return;
                }

                adminNewsList.innerHTML = '';
                const snapshot = await db.collection('news')
                    .orderBy('createdAt', 'desc')
                    .get();

                snapshot.forEach(doc => {
                    const news = doc.data();
                    const newsItem = document.createElement('div');
                    newsItem.className = 'news-item';
                    newsItem.innerHTML = `
                        <div class="info">
                            <span class="category">${getTranslatedCategory(news.category)}</span>
                            <span class="date">${news.dateTime}</span>
                            <h3>${news.title}</h3>
                            <p>${news.content.substring(0, 50)}...</p>
                        </div>
                        <button onclick="deleteNews('${news.id}')">Hapus Berita</button>
                    `;
                    adminNewsList.appendChild(newsItem);
                });
            } catch (error) {
                console.error('Error loading admin news list:', error);
            }
        }

        async function deleteNews(newsId) {
            if (!db) {
                alert('Firebase tidak tersedia. Tidak dapat menghapus berita.');
                return;
            }

            if (confirm('Apakah Anda yakin ingin menghapus berita ini?')) {
                try {
                    await db.collection('news').doc(newsId).delete();

                    const newsItem = document.querySelector(`#news-items .news-item[onclick="showNewsDetail('${newsId}')"]`);
                    if (newsItem) newsItem.remove();
                    const newsPage = document.getElementById(newsId);
                    if (newsPage) newsPage.remove();

                    newsData = newsData.filter(n => n.id !== newsId);
                    if (db) loadAdminNewsList();
                    if (db) loadNews();
                    alert('Berita berhasil dihapus!');
                    showPage('news-list');
                } catch (error) {
                    console.error('Error deleting news:', error);
                    alert('Gagal menghapus berita. Silakan coba lagi.');
                }
            }
        }

        function updateDeleteButtonsVisibility() {
            const deleteButtons = document.querySelectorAll('.delete-btn');
            deleteButtons.forEach(button => {
                if (isLoggedIn) {
                    button.classList.add('visible');
                } else {
                    button.classList.remove('visible');
                }
            });
        }

        function updateNavigation() {
            const nav = document.getElementById('nav-links');
            if (!nav) {
                console.error('Navigation element not found.');
                return;
            }
            const existingAdminLink = nav.querySelector('a[onclick="showPage(\'admin\')"]');
            if (isLoggedIn) {
                if (!existingAdminLink) {
                    const adminLink = document.createElement('a');
                    adminLink.textContent = 'Admin';
                    adminLink.setAttribute('onclick', "showPage('admin')");
                    nav.appendChild(adminLink);
                    console.log('Admin link added to navigation.');
                }
            } else {
                if (existingAdminLink) {
                    nav.removeChild(existingAdminLink);
                    console.log('Admin link removed from navigation.');
                }
            }
        }

        function logout() {
            isLoggedIn = false;
            sessionStorage.removeItem('isLoggedIn');
            updateNavigation();
            updateDeleteButtonsVisibility();
            alert('Logout berhasil!');
            showPage('home');
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded and parsed.');
            const form = document.getElementById('add-news-form');
            if (form) {
                form.addEventListener('submit', addNews);
            } else {
                console.error('Form with ID "add-news-form" not found.');
            }
            // Selalu tampilkan halaman beranda saat halaman dimuat
            showPage('home');
            // Muat berita hanya jika Firebase tersedia
            if (db) {
                loadNews();
            } else {
                console.warn('Skipping loadNews because Firebase is not initialized.');
            }
            updateNavigation();
        });

        // Deteksi error script loading
        window.onerror = function(message, source, lineno, colno, error) {
            console.error(`Script error detected: ${message} at ${source}:${lineno}:${colno}`, error);
            alert('Terjadi kesalahan pada skrip. Silakan periksa konsol browser untuk detail lebih lanjut.');
        };
    </script>
</body>
</html>
